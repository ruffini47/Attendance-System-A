<% provide(:title, "Time log") %>
<h1>勤怠ログ</h1>
<div>
  <%= form_with(model: @attendance, url: '#', local: true)  do |f| %>
    <div class = "form-group">
      <%= link_to "リセット", '#', class: "btn btn-default" %>
    </div>
    <div class = "select_year_month">
      <%= f.select :year, options_for_select((2017..2022)), { include_blank: "年"}, { class: "form-control"} %>
      <%= f.select :month, options_for_select((1..12)), { include_blank: "月"}, {onchange: "submit(this.form)", class: "form-control"} %>
    </div>
  <% end %>
</div>
<div>
  <table class="table table-bordered table-condensed table-striped table-hover at-work-table">
    <thead>
      <colgroup>
        <col style='width:60px;'>
        <col style='width:80px;'>
        <col style='width:80px;'>
        <col style='width:60px;'>
        <col style='width:60px;'>
        <col style='width:45px;'>
        <col style='width:60px;'>
      </colgroup>
      <tr>
        <td>日付</td>
        <td>変更前出社時間</td>
        <td>変更前退社時間</td>
        <td>変更後出社</td>
        <td>変更後退社</td>
        <td>指示者</td>
        <td>承認日</td>
      </tr>
    </thead>
    <tbody>
      <% @attendances.each do |day| %>
        <tr>
          <td><%= day.worked_on.strftime("%Y-%m-%d")%></td>
          <% if day.time_log_count == 1 %>
            <td></td>
            <td></td>
          <% else day.time_log_count %>
            <td><%= day.before_change_start_time.strftime("%H:%M") %></td>
            <td><%= day.before_change_end_time.strftime("%H:%M") %></td>
          <% end %>
          <td><%= day.started_at.strftime("%H:%M") %></td>
          <td><%= day.finished_at.strftime("%H:%M") %></td>
          <td><%= User.find(day.saved_attendance_change_to_superior_user_id).name %></td>
          <td><%= day.attendance_change_approved_datetime.strftime("%Y-%m-%d") %></td>
        </tr>
      <% end %>  
    </tbody>
  </table>
</div>
